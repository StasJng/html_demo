<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://code.jquery.com/jquery-2.2.4.min.js" integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44=" crossorigin="anonymous"></script>
    <title>Document</title>
</head>
<style>
    .range-ctn {
        width: 500px;
/*      width: 100%;
        padding: 15px; */
    }

    .range-slider {
        height: 5px;
        position: relative;
        background-color: #f5f5f5;
        border-radius: 2px;
    }

    .range-selected {
        height: 100%;
        left: 0;
        right: 0;
        position: absolute;
        border-radius: 5px;
        background-color: #F6911E;
    }

    .range-input {
        position: relative;
    }

    .range-input input {
        position: absolute;
        width: 100%;
        height: 5px;
        top: -7px;
        left: -2px;
        background: none;
        pointer-events: none;
        -webkit-appearance: none;
        -moz-appearance: none;
        cursor: pointer;
        z-index: 2;
    }

    .range-input input::-webkit-slider-thumb {
        height: 20px;
        width: 20px;
        border-radius: 50%;
        border: 3px solid #F6911E;
        background-color: #F6911E;
        pointer-events: auto;
        -webkit-appearance: none;
    }

    .range-input input.default::-webkit-slider-thumb {
        border: 3px solid #eee;
        background-color: #eee;
    }

    .range-input input::-moz-range-thumb {
        height: 15px;
        width: 15px;
        border-radius: 50%;
        border: 3px solid #F6911E;
        background-color: #fff;
        pointer-events: auto;
        -moz-appearance: none;
    }

    .range-price {
        height: 25px;
        position: relative;
    }

    .range-price .min-p, .range-price .max-p {
        position: absolute;
        font-size: 14px;
        font-weight: 400;
        color: #000;
        top: 50%;
    }

    .range-price .min-p {
        left: 5px;    
    }

    .range-price .max-p {
        right: 5px;
    }
</style>
<body>
    <div class="range-ctn">
        <div class="range-slider">
            <span class="range-selected"></span>
        </div>

        <div class="range-input">
            <input type="range" id="min-price" class="min default" min="0" max="1000000" value="0" step="100000">
            <input type="range" id="max-price" class="max default" min="0" max="1000000" value="1000000" step="100000">
        </div>

        <div class="range-price">      
            <input type="hidden" name="min" value="0">      
            <input type="hidden" name="max" value="100000">      
            <span class="min-p" id="min-p-txt">0</span> 
            <span class="max-p" id="max-p-txt">1.000.000đ</span>
        </div>
    </div> 

    <script>
        function sleep(ms) {
            return new Promise(resolve => setTimeout(resolve, ms));
        }

        let rangeMin = 100000;
        const range = document.querySelector(".range-selected");
        const rangeInput = document.querySelectorAll(".range-input input");
        const rangePrice = document.querySelectorAll(".range-price input");

        rangeInput.forEach((input) => {
            input.addEventListener("input", (e) => {
                sleep(500);

                let minRange = parseInt(rangeInput[0].value);
                let maxRange = parseInt(rangeInput[1].value);

                if (maxRange - minRange < rangeMin) {     
                    if (e.target.className === "min") {
                        rangeInput[0].value = maxRange - rangeMin;        
                    } 
                    else {
                        rangeInput[1].value = minRange + rangeMin;        
                    }
                } else {
                    rangePrice[0].value = minRange;
                    rangePrice[1].value = maxRange;
                    range.style.left = (minRange / rangeInput[0].max) * 100 + "%";
                    range.style.right = 100 - (maxRange / rangeInput[1].max) * 100 + "%";

                    if(minRange == 0) {
                        $('#min-price').addClass("default");
                    } else {
                        $('#min-price').removeClass("default");
                    }

                    if(maxRange == parseInt($('#max-price').attr('max'))) {
                        $('#max-price').addClass("default");
                    } else {
                        $('#max-price').removeClass("default");
                    }
                }

                $('#min-p-txt').html(new Intl.NumberFormat().format(rangeInput[0].value) + 'đ'); 
                $('#max-p-txt').html(new Intl.NumberFormat().format(rangeInput[1].value) + 'đ');
            });
        });

        rangePrice.forEach((input) => {
            input.addEventListener("input", (e) => {
                sleep(500);

                let minPrice = rangePrice[0].value;
                let maxPrice = rangePrice[1].value;

                if (maxPrice - minPrice >= rangeMin && maxPrice <= rangeInput[1].max) {
                    if (e.target.className === "min") {
                        rangeInput[0].value = minPrice;
                        range.style.left = (minPrice / rangeInput[0].max) * 100 + "%";
                    } else {
                        rangeInput[1].value = maxPrice;
                        range.style.right = 100 - (maxPrice / rangeInput[1].max) * 100 + "%";
                    }
                }
            });
        });
    </script>
</body>
</html>